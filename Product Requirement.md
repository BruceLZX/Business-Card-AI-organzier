# BusinessCardAIAssisstant — 档案页面用例说明（中文）

本文档为当前产品需求的正式说明，重点包含：
- **联系人档案页 / 公司档案页的详细用例与交互**（本次重点）
- AI 补全与 Tag 规则

---

## 1) 联系人档案页面（Detail）— 用例与行为

### 1.1 目的
让用户“一眼知道这个人是谁、做什么、怎么联系、属于哪个公司、有哪些照片/标签/备注”。

### 1.2 结构与信息模块（建议顺序）
- **顶部识别区**：姓名（英文 + 中文可切换显示）、职位、公司名称（可跳转）。
- **AI 总结模块**：
  - 点击“使用 AI 搜索/补全”前，展示占位文案（例如“使用 AI 搜索获取该联系人总结”）。
  - 触发后显示 AI 生成的 summary（任职/背景等），来源包括 LinkedIn/个人官网等。
  - 若无结果显示“未找到有效信息”。
- **联系信息模块**：电话、邮箱、个人网站、LinkedIn。
  - 电话点击直接跳转拨号界面并带入号码。
  - 网站/LinkedIn 点击打开系统浏览器访问 URL。
- **公司关联模块**：可关联**多个公司**的列表、公司跳转按钮。
  - 模块下方有**蓝色按钮**“关联新公司”，用于新增关联。
  - 该按钮**仅打开已有公司列表选择**，不允许在此新建。
  - 新建公司仅允许在主页通过拍照或手动创建完成后再关联。
  - 关联模块不使用 Edit 按钮。
- **备注模块**：用户备注。
- **标签模块**：标签列表（来自 tag pool）。
- **照片模块**：名片/资料图片列表。
- **底部操作**：删除联系人档案（红色按钮）。

### 1.3 主要用例（联系人档案页）
1. **查看联系人信息**
   - 展示中英文姓名、职位、联系方式、所属公司。
   - 电话/邮箱/网站/LinkedIn 可点击。

2. **编辑单一模块**
   - 每个模块右上角有 Edit（**关联模块除外**）。
   - Edit 仅编辑该模块，不影响其他模块。

3. **切换档案显示语言**
   - 页面顶部有 EN/中文切换按钮。
   - **仅影响当前档案页面**，离开后恢复系统语言。

4. **关联已有公司**
   - 在“公司关联模块”选择已有公司（可多选）。
   - 选择后联系人档案更新关联关系，并显示公司跳转列表。

5. **取消关联公司**
   - 支持清除单个公司关联（已确认需要）。
   - 清除后列表中移除对应公司。
   - 解除后需**立即刷新**当前页面，不要求用户离开再进入。

6. **移除关联（长按）**
   - 通过长按关联公司弹出确认提示，确认后解除关联。
   - 不依赖 Edit 按钮。

7. **添加照片**
   - 可从相机或图库添加（**统一上限 10 张**）。
   - 可删除已添加照片。

8. **删除联系人**
   - 删除后，关联公司中的“相关联系人”列表同步移除该联系人。

---

## 2) 公司档案页面（Detail）— 用例与行为

### 2.1 目的
让用户“一眼知道公司做什么、规模、业务、如何联系、关联哪些人、有哪些资料图片”。

### 2.2 结构与信息模块（建议顺序）
- **顶部识别区**：公司名称（英文 + 中文可切换）、公司简介、行业。
- **AI 总结模块**：
  - 与联系人一致，展示公司 summary（来源包括 LinkedIn/官网/社媒）。
  - 无结果则显示“未找到有效信息”。
- **公司基础信息模块**：规模、营收、成立时间、总部、地址、电话。
- **业务模块**：服务类型、目标客户、市场区域。
- **链接模块**：官网、LinkedIn（可点击打开浏览器）。
- **联系人模块**：关联联系人列表（可跳转联系人档案）。
  - 模块下方有**蓝色按钮**“关联新联系人”，用于新增关联。
  - 该按钮**仅打开已有联系人列表选择**，不允许在此新建。
  - 新建联系人仅允许在主页通过拍照或手动创建完成后再关联。
  - 关联模块不使用 Edit 按钮。
- **备注模块**：用户备注。
- **标签模块**：标签列表（来自 tag pool）。
- **照片模块**：宣传册/资料/名片图片。
- **底部操作**：删除公司档案（红色按钮）。

### 2.3 主要用例（公司档案页）
1. **查看公司信息**
   - 展示中英文公司名、简介、行业、规模、营收等。
   - 官网/LinkedIn 为可点击链接。

2. **编辑单一模块**
   - 每个模块右上角有 Edit（**关联模块除外**）。
   - Edit 仅编辑该模块，不影响其他模块。

3. **切换档案显示语言**
   - 页面顶部有 EN/中文切换按钮。
   - **仅影响当前档案页面**，离开后恢复系统语言。

4. **关联已有联系人**
   - 在“联系人模块”选择已有联系人进行关联。
   - 关联后联系人档案也显示该公司跳转。

5. **移除关联联系人（已确认）**
   - 单个移除（仅解除关联，不删除联系人档案）。
   - 解除后需**立即刷新**当前页面，不要求用户离开再进入。

6. **移除关联（长按）**
   - 长按联系人弹出确认提示，确认后解除关联。
   - 不依赖 Edit 按钮。

7. **添加照片**
   - 可从相机或图库添加（**统一上限 10 张**）。
   - 可删除已添加照片。

8. **删除公司**
   - 删除后，所有关联联系人中的“所属公司”字段清空。

---

## 3) AI 补全按钮（档案页）

- 按钮显示在档案顶部，用蓝色突出。
- 点击后：按钮切换为进度条，**期间该档案页面禁止编辑**，但用户可浏览其他页面。
- 点击后：**用户无法进行任何操作**（含点击/切换/返回），直到补全完成。
- 进度条分阶段推进：
  - 阶段 1：照片内容分析（mini 模型）。
  - 阶段 2：联网搜索（thinking 模型，分多个子阶段，不同 prompt 从不同角度搜索）。
  - 阶段 3：合并与去重（将照片分析与搜索结果融合输出）。
  - 阶段文案显示为“正在 xxxx”，完成后显示“完成！”并展示内容。
  - 阶段数量允许动态调整，最多 5 个阶段。
- 完成后：进度条消失，字段更新。
  - 更新字段显示为蓝色。
  - 若字段被更新，显示**原有内容**（用于对比验证，格式建议为“原有内容：xxx”）。
- 若原字段非空，则该字段提供“撤销替换”按钮。
  - 撤销按钮采用更明显的样式与更大可点击区域。
- 补全入口需要保留：
  - 完成一次补全后，按钮文案改为“再次使用 AI 搜索/补全”。
- Prompt 规则：
  - 若扫描已识别出个人网站/LinkedIn/官网链接，**优先基于这些链接进行搜索**。
  - 搜索目标与范围需明确（例如：职位、任职经历、公司简介、业务与规模等）。
- AI 总结为**只读**，用户补充信息请写在 Notes 模块。
- AI 补全采用“分步工作链”：
  1. 先基于照片（名片/册子）提取未写入档案的补充信息（岗位、产品、公司介绍等）。
  2. 再结合现有档案信息进行联网搜索与校验（优先官网/LinkedIn/个人网站）。
  3. 合并两部分结果输出，**避免与现有字段重复显示**。
- 搜索范围扩展：
  - 公司：营收/盈利、合作伙伴、是否上市、业务范围与产品细节。
  - 个人：任职经历、职位、所属公司、相关业务领域等。
- AI 补全需对照现有信息进行验证，避免同名不同人/公司导致混入无关信息。
  - 若“看起来可能是同一人/公司但证据不足”，信息用【可能不准确】标记该字段或段落。
  - 不确定标记必须精确到具体字段或段落，避免影响已确认信息。
- Tag 补全：
  - AI 生成 tag 用 mini 模型。
  - 先从 tag pool 匹配；无命中才新建。
  - tag 需要区分“公司 tag / 个人 tag”字段集合，**集合不固定**，可根据需求扩展。
  - 作为投资人/潜在合作方视角，建议覆盖以下方向（可扩展）：
    - 公司：行业/赛道、业务类型、服务对象（B2B/B2C/B2G）、产品/技术关键词、商业模式、营收阶段、融资阶段、合作伙伴、市场区域/国家、交付能力。
    - 个人：职位级别、职能方向（产品/技术/销售/BD/运营）、行业背景、地域、关联公司数量、主要资源/能力。

---

## 4) Tag / Tag Pool

- Tag 默认必须为**单词**（无空格/标点）。
- 若用户手动新增 Tag，可以允许包含空格/标点。
- Tag Pool 为独立可搜索列表。
- 添加 Tag 优先选择已有 Tag，可新增新 Tag。

---

## 5) 已确认规则

1. 目录页：如果目标语言缺失，回退显示已有语言（有什么显示什么）。
2. “可能不准确”标记使用黄色样式。
---

## 6) 问题列表

1. 长按关联对象，点击删除后，画面没有更新，需要离开当前页面再重新进入后才会删除对象才会真正消失。
2. 设置中的外观中的“跟随系统没有起到作用”，我不清楚为什么，但是到了晚上的时候系统依旧是白色的。也许可以改成根据时间？白天的时候是白色，落日到日出前是黑色。
3. 使用AI补全的功能不完善。网上可能有类似的公司或者人名，导致搜索的时候会把其他人的信息搜罗过来。
4. 为了解决3， 需要AI补全功能使用chatgpt的thinking那个api，虽然贵一点，但是结果应该可以更好。
5. 为了解决3，ai进行补全搜索的时候应该加入已有的公司和个人信息。基于这些已有信息开始搜索。既可以进行匹配以防内容出错，同时也可以确保有搜索方向，比如，如果现有档案已经有网址，那么可以先搜索网址内容。个人搜索也是这样，如果有网址搜索网址，有个人信息那么可以对照个人信息，包括但不限于岗位，在职公司，联系方式等。比如，一个中国公司，人也在中国工作，但是搜索到一个在美国工作的同名同姓的人，那他们肯定不是同一个人了。当然，要注意的是一个人可能在多个公司任职，所以有可能网上可以搜索到同一个人但是隶属公司不同，这种情况下就需要对照个人信息，然后把搜索符合的信息都加上。
6. ai补全内容可以先从照片内容入手，分析这个人的岗位等信息以及公司的信息，当然，ai补正的信息不应该和档案里的信息重复显示。在公司方面，小册子上一般会有公司的自我介绍，产品，产品细节等内容。你可以吧这些内容也包括在AI补全内容中。在此之上，再加入你再网上搜索到的相关信息。
7. 所以我需要你再ai补全的功能上建立一个ai工作链：先根据照片分析没有包括在档案里的关于公司/个人的其他信息，然后再结合档案里有的信息上网搜索对应正确的公司/个人。最后，把这两部分内容结合起来，输出给用户。
8. 关于网上搜索的部分，公司方面你可以搜索这个公司过往的盈利，合作伙伴，是否上市等内容，而不仅限公司业务等内容。搜索人物也是一样。
9. 在目录上，公司和人的名字显示不管是哪种语言都显示英语，请修复这个问题。显示的名字所使用的语言应该符合系统语言。
10. ai补全应该包括tag的补全，基于ai搜索搜罗到的信息，更新这个公司/人的相关tag。tag的增加可以使用gpt mini，便宜版本的足够了。tag的增加和创建依旧要符合下列规则：先从已有的tag pool中进行选择，然后没有符合的情况下在新建tag。tag可以包括但不限于业务范围，业务具体内容，工作地方（城市），工作国家，等等。
11. app 的 icon图片仍然不够大，需要再放大一点，然后其他没用的图片请删掉，不要保留。
12. 使用ai补全以后档案被填入的新的资料已经变成蓝色显示，但是可以的话我希望能够显示原有文字是什么，方便用户进行比较和验证。此外，撤销按钮太小了，请换一个形制的同时搞的大一点，当然，不要太丑。

本 README 作为后续开发的唯一基准。

---

## 7) To Do（解决计划）

1. **长按解除关联立即刷新**
   - 确认解除关联后立即刷新本页数据源与 UI。
   - 处理关联列表与详情页状态同步。
   - 关联新增按钮的外观与关联方块统一风格，保持一致性。

2. **外观“跟随系统”失效**
   - 排查系统色模式绑定逻辑。
   - 改为“按本地日出/日落自动切换”；若无日出日落数据，使用 18:00–06:00 作为回退。

3. **AI 补全质量升级**
   - 将补全过程拆分：照片分析（mini）→ 多阶段联网搜索（thinking）→ 合并与去重。
   - 联网搜索分多个阶段，不同 prompt 从不同角度搜集信息。
   - 合并时去重，避免与已有字段重复显示。
   - 进度条阶段文案采用“正在 xxxx”，完成后显示“完成！”，停留 1 秒。
   - 阶段数量允许动态调整，最多 5 个阶段。
   - 补全期间禁止任何操作（包含点击/切换/返回）。
   - 更新字段显示原有内容，便于对比验证。
   - 撤销按钮使用更明显且更大的样式。

4. **AI 搜索去同名误差**
   - 使用已有字段进行搜索与验证（公司/岗位/国家城市/官网/LinkedIn）。
   - 对搜索结果做一致性校验，不匹配则丢弃。
   - 对“可能正确但证据不足”的信息加【可能不准确】标记。
   - 不确定标记精确到字段级别或段落级别。

5. **AI 补全 Tag 规则**
   - 先在 tag pool 中匹配；未命中时创建新 tag。
   - AI 生成 tag 用 mini 模型，确保为单词格式。
   - Tag 区分公司/个人字段集合（不固定，可扩展）。
   - Tag 覆盖范围更广，优先满足“投资人/合作方快速定位”需求。

6. **补全结果对比与撤销**
   - 更新字段显示原有内容（按字段/段落级别展示）。
   - 撤销按钮改为更明显样式（更大可点击区域）。

7. **目录语言显示**
   - 仅按系统语言显示；中文系统显示中文名，英文系统显示英文名。

8. **App Icon 放大**
   - 进一步放大 icon 中心区域。
   - 删除未使用的图标源文件与多余图片。
